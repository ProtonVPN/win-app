<?xml version="1.0" encoding="utf-8"?>

<!--
Copyright (c) 2023 Proton AG

This file is part of ProtonVPN.

ProtonVPN is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

ProtonVPN is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with ProtonVPN.  If not, see <https://www.gnu.org/licenses/>.
-->

<Page x:Class="ProtonVPN.Client.UI.Countries.CountriesPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:toolkit="using:CommunityToolkit.WinUI.UI.Controls"
      xmlns:controls="using:ProtonVPN.Client.Common.UI.Controls"
      xmlns:models="using:ProtonVPN.Client.Models"
      xmlns:pathIcons="using:ProtonVPN.Client.Common.UI.Assets.Icons.PathIcons"
      x:Name="PageArea"
      mc:Ignorable="d">

    <controls:PageContentControl BackCommand="{x:Bind ViewModel.GoBackCommand}"
                                 IsCompact="{x:Bind ViewModel.IsNavigationPaneCollapsed, Mode=OneWay}"
                                 PageHeader="{x:Bind ViewModel.Title}">

        <StackPanel x:Name="ContentArea"
                    Orientation="Vertical">

            <NavigationView Style="{StaticResource TopNavigationViewStyle}">
                <NavigationView.MenuItems>
                    <NavigationViewItem Content="Cities" x:Name="CitiesPage">
                    </NavigationViewItem>
                    <NavigationViewItem Content="Secure Core" x:Name="SecureCorePage">
                        <NavigationViewItem.Icon>
                            <pathIcons:LockLayers />
                        </NavigationViewItem.Icon>
                    </NavigationViewItem>
                    <NavigationViewItem Content="P2P" x:Name="P2PPage">
                        <NavigationViewItem.Icon>
                            <pathIcons:ArrowRightArrowLeft />
                        </NavigationViewItem.Icon>
                    </NavigationViewItem>
                    <NavigationViewItem Content="Tor" x:Name="TorPage">
                        <NavigationViewItem.Icon>
                            <pathIcons:BrandTor />
                        </NavigationViewItem.Icon>
                    </NavigationViewItem>
                </NavigationView.MenuItems>
            </NavigationView>

            <Border Margin="0,0,0,24"
                    Padding="24,16"
                    x:DefaultBindMode="TwoWay"
                    BorderBrush="{StaticResource BorderWeakColorBrush}"
                    BorderThickness="1">

                <StackPanel Orientation="Vertical"
                            Spacing="12">
                    <TextBox AutomationProperties.AutomationId="EntryCountryCodeTextBox"
                             Header="Exit Country:"
                             MaxLength="2"
                             PlaceholderText="Country code"
                             Text="{x:Bind ViewModel.ExitCountryCode, UpdateSourceTrigger=PropertyChanged}" />
                    <TextBox AutomationProperties.AutomationId="CityStateTextBox"
                             Header="City/State:"
                             IsEnabled="{x:Bind ViewModel.IsNotEmpty(ViewModel.ExitCountryCode), Mode=OneWay}"
                             PlaceholderText="City/State name"
                             Text="{x:Bind ViewModel.CityState}" />
                    <TextBox AutomationProperties.AutomationId="ServerNumberTextBox"
                             Header="Server:"
                             IsEnabled="{x:Bind ViewModel.IsNotEmpty(ViewModel.ExitCountryCode), Mode=OneWay}"
                             PlaceholderText="Server number"
                             Text="{x:Bind ViewModel.ServerNumber}" />

                    <StackPanel Orientation="Horizontal"
                                Spacing="32">
                        <ComboBox Width="160"
                                  Header="Features:"
                                  ItemsSource="{x:Bind ViewModel.Features, Mode=OneTime}"
                                  SelectedItem="{x:Bind ViewModel.SelectedFeature}" />
                        <TextBox Width="160"
                                 Header="Entry Country:"
                                 IsEnabled="{x:Bind ViewModel.IsSecureCore, Mode=OneWay}"
                                 MaxLength="2"
                                 PlaceholderText="Country code"
                                 Text="{x:Bind ViewModel.EntryCountryCode}" />
                    </StackPanel>

                    <toolkit:DockPanel LastChildFill="False">
                        <Button Margin="0,8,16,0"
                                toolkit:DockPanel.Dock="Left"
                                AutomationProperties.AutomationId="CountriesConnectButton"
                                Command="{x:Bind ViewModel.ConnectCommand, Mode=OneWay}"
                                Content="Connect"
                                Style="{StaticResource PrimaryButtonStyle}" />
                        <Button Margin="0,8,16,0"
                                toolkit:DockPanel.Dock="Left"
                                AutomationProperties.AutomationId="CountriesFreeConnectButton"
                                Command="{x:Bind ViewModel.FreeConnectCommand, Mode=OneWay}"
                                Content="Free Connect" />
                        <Button Margin="16,8,0,0"
                                toolkit:DockPanel.Dock="Right"
                                AutomationProperties.AutomationId="CountriesAutoConnectButton"
                                Command="{x:Bind ViewModel.SimulateManyConnectionsCommand, Mode=OneWay}"
                                Content="Auto" />
                    </toolkit:DockPanel>
                </StackPanel>
            </Border>
            <ItemsControl ItemsSource="{x:Bind ViewModel.Countries}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Vertical"
                                    Spacing="8" />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate x:DataType="models:Country">
                        <Button Command="{Binding ViewModel.NavigateToCountryCommand, ElementName=PageArea}"
                                CommandParameter="{x:Bind}"
                                Content="{x:Bind CountryName}" />
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </StackPanel>
    </controls:PageContentControl>
</Page>